ct_root5_q = [61937505492216681393066067336770854633853719462972646759613624207831716228867294960077383010294893644316876293598471310601577466475298605620915713538704060093857371326988664843998116345565336196107680785602817601213825648441768940853952555720473047067886482821966276299059506898513864795921426746957942127267,
 31962647746545740052567851239581743872268403851511899997529011071566744074890640236916476402306572923277538655245886836514047377887233431856249965025929207134532545228794418858342225214647073918944846659027034688089709070226020766336152227707347654246232971795649643672652091617884336008509009810596391002495,
 5039299394803891847654258085139088232398504179592951230068973691755300059026458710027704183192095439703673140585717913919879409792862234880660541389146509745199028084514549343158113103914095052216183455921975159021811180749389916666325937900256991242816948179568943889762329786801225622957288992359887800586,
 86017631513893711213586607447439834582549606505237560004961577677029900831747929368795965522568817818694782604275047118767548810031032216777058677258585488441499076913325716475958384274286788886993681326427403380670911218953331119654778363533947169778750778718414676413307973317615647855256145890775676274256,
 39470307663484260323568104921721543319634624957368308713449180358355691916336879182209829520485376651897042966783650127545773759130967013212803989576851228017018150900197813279599496758198944305495839392578355358226506411509067371537941614140302516569933115045650912808436864711880685381625119448723497044878]
ct_root5_p = [37314947745757168809413161964989715517984674901956322827394736352684308228166507831193968624907483189069550981256792595982106333583741840221397290427049042105826905909109281728727010900990529838774780574481678425137377786018125301909786852162928610010188338972520287306086327263198574120735264552604228807568]
ct_root3_p = [42452653676929257171248121734541764070668192417344706390220558163105963207378488847874392627480732598943320535886709235316693412915077424684354960920748482783426348570376557437430564219522441104994357646538070993776132671148717782293261346236856733231415624983404919811035581892093852204607513992904409630555]
ct_root3_q = [34838354070043284771137678638456317967607901727583781060784641081880652079040458932242277704452758824530094414057617131858974756409461497991054463076147893354558842011719648206327578982790646659764064422287939408547849595780524871654108133115731479941038248383490762107947323137229820531236688559480102986187]
ct_root7_p = [22930072886485582786901977742740236713961599088758658020276640863647503755965047316326957650618466284130652045026362294811206223592513070007654507776315183681259686729370148696179837632602980964442019626041020734701250397695352294365662617974026684510982537384210401383547075814175462021076056564657584998139]
ct_root7_q = [48118183156688432026794519226936899569839587020644225841220601682885017887814104525841391694193695930387820363842837660501848966151664534139455142291540189738475531082980434653782212252998019313871313527861764012203124854426359919504084913801951423517768929872187138420785254838786868660735407199182855418956]


def exists(ct):
    prime_list = []
    for prime in primes(8,1000):
        if GF(p)(ct).nth_root(prime,all=True) and GF(q)(ct).nth_root(prime,all=True):
            prime_list.append(prime)
            print(prime)
    return prime_list


def kth_root()

def gen_rsa(ct,p,q):
    n = p*q 
    phi = (p-1)*(q-1)
    e = 4200
    while True:
        if e%2!=0 and gcd(e,phi)!=1:

        e+=1

from itertools import product
def nth_root(ct,e,p,q):
    n=p*q
    if e%2==0:
        return []
    p_roots = GF(p)(ct).nth_root(e,all=True)
    if p_roots == []:
        return []
    q_roots = GF(q)(ct).nth_root(e,all=True)
    if q_roots == []:
        return []
    roots = []
    for rp,rq in product(p_roots,q_roots):
        roots.append(crt(int(rp),int(rq),int(p),int(q)))
    return roots

e=4201
phi = (p-1)*(q-1)
while True:
    if gcd(phi,e)!=1:
        for root in nth_root(ct,e,p,q):
            m = long_to_bytes(root)
            # print(e,m)
            if b'CTF' in m:
                print(m)
                break
        print(e)
    e+=1

