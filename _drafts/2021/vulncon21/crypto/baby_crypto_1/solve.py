n1 = 22243767031601205606016724543394930965574710684607939977002923653467515703910708073153303837197514453047530981163061414432553406922379064426711180712199214148695524074852292709843679483946765826870486767413648398940133262658583561865532248340848798197069347180941760889923311080443408332311280000720444030202313987744329723440602348873266088225457793745023406168229198052883533457979075930671593721756049119623439980058663481487875407803740428753364349578448179538422057210061297317455298747898736294488215527556155413660495462710790183196097603497852931743336515415984055572082317119324317677742645961245335632851491
n2 = 22243767031601205606016724543394930965574710684607939977002923653467515703910708073153303837197514453047530981163061414432553406922379064426711180712199214148695524074852292709843679483946765826870486767413648398940133262658583561865532248340848798197069347180941760889923311080443408332311280000720444088631755201518863682427020328661800944870199966918281743538003953548886667168717595850683487724572933861527424312817284865432246601050829245671332285117732021604161087765520706258045960134431616629369489298042899004980834927326168764114693314977815338647689995504140027507603785895207956532803125995629781105125051
c1 = 21015887075421597796881082947987101126069551861907298153305115458195043650321017152078923571591176106457664970164210111446945546910454719331155256239779901883809540555018856905735566026769497037893656895619950331023776596397084788049341711529298269351942650618644778314295214814482899243754667427202019028761299527182084519600480383057195877660162355968191754720194183870387237310465727792481211316959702803683072186328458267125586299697285649619652001364385177367764033046337354326442405138998227801884286911634858441035727869447332895575415317302333865925984575835983462914397463753678529746998277861755912512542253

LIMIT = 2000
from tqdm import tqdm
from Crypto.Util.number import *
from math import gcd
from gmpy2 import isqrt, next_prime


v1,v2 = 0x1337, 0x69420


def fac(LIMIT):
    for x in tqdm(range(1,LIMIT,2)):
        for y in range(0,LIMIT,2):
            X,Y = v1+x, v2+y
            b = n2-n1-X*Y
            D = isqrt(b**2 - 4*X*Y*n1)
            if gcd(b+D,n1)!=1 or gcd(b-D,n1)!=1:
                p = gcd(b+D,n1)
                q = n1//p
                return p,q

p,q = fac(1000)
print(p,q)

m = pow(c1,pow(65537,-1,(p-1)*(q-1)),n1)
print(m.to_bytes( (m.bit_length()+7)//8,'big'))


