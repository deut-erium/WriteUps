import sympy


CipherText=149596971555589076155364186420580570749374401138608961998290009825114263148416772478651277321234724062278466223025831775035224109103887370927097231230324908201908263749968832767737017862796581877535194538767636598004538397685647433625803605580636107271455294998120570215920206140799513104969815764397323782297061528436771406170006449117531288516762624306954764709977440515034071280736026924741057203047657693649914954727759355179977253548864147305088480009948437
Alice=282107567413424138126415916172126379762973487029431335677677351999909735485304760228208386658075380503123901137419658654328175448732740174233462536318627304974901304879611754592414594362308597516549359004265409028150117237817823179344527892839743549388806946124113890322466683297081312475367783738162570544520549179569150033008482592884468354854459703961697842606812
Bob=66444211849564598649204285138638077348678558382508976397654912859551087895603398701542655997585482323573895063934558694018052442406995794312376093987279068684491709029458439225825559371474422839752950009253788191772668126664288610488535211383255806288769703027437108720296265682565379886651381942112538908474625781728851722312089113677698489150478927871052981645551018211694817730263647445568601019977068831413100897642519594589716447525199022801203505747758062305119871983246399979915166157

for i in range(2,1024):
    xemu = 2**i-1
    if sympy.isprime(xemu):
        print(i)
        if Bob%xemu==0:
            q = Bob//xemu
            p = Alice - xemu**2
            n = p*q
            e = 65537
            phi = (p-1)*(q-1)
            d = pow(e,-1,phi)
            flag_int = pow(CipherText,d,n)
            flag = flag_int.to_bytes( (flag_int.bit_length()+7)//8,'big')
            print(flag)
            break

#p_ctf{M3rs5nne_pr1mes_4re_c00l}
